@{
    ViewBag.Title = "Watcher";
}

<h1>Welcome to Watcher!</h1>

<div class="row">
    <div class="col-md-4">
        <input type="text" class="form-control" id="search" placeholder="Search..">
        
        <br/>
        <div style="margin-top: 10px; margin-bottom: 10px;">
            <ul id="searchList"></ul>
        </div>
        
        <h2>Top rated TV-shows</h2>
        <div style="margin-top: 10px; margin-bottom: 10px;">
            <ul id="topRated"></ul>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $.ajax({
            dataType: "json",
            type: 'POST',
            url: '@Url.Action("TopRated", "Home")',
            success: displayTopRated,
        });
    });

    $('#search').on('input', function() {
        if ($('#search').val().length >= 3) {
            $.ajax({
                dataType: "json",
                type: 'POST',
                url: '@Url.Action("Search", "Home")',
                data: {
                    input: $('#search').val()
                },
                success: displaySearchResults,
            });
        }
    });

    function displayTopRated(data) {
        $('#topRated').empty();

        for (var i = 0; i < data.result.length; i++) {
            $('#topRated').append('<li id=' + data.result[i].Id + 'class="test"' + '><a href="">' + data.result[i].Name + '</a></li>');
        }
    }

    function displaySearchResults(data) {
        $('#searchList').empty();

        for (var i = 0; i < data.result.length; i++) {
            $('#searchList').append('<li id=' + data.result[i].Id + 'class="test"' + '><a href="">' + data.result[i].Name + '</a></li>');
        }
    }
</script>